x1_step1.xoffset = [-1500;-1500;-1500;-1500;-1500;-1500;-1500;-1500;-1500;-1500;-1500;-1500;-1500;-1500;-1500;-1500;-1500;-1500;-1500;-1500;-1500;-1500;-1500;-1500;-1500;-1500;-1500;-1500;-1500;-1500;-1500];
x1_step1.gain = [0.002;0.002;0.002;0.002;0.002;0.002;0.002;0.002;0.002;0.002;0.002;0.002;0.002;0.002;0.002;0.002;0.002;0.002;0.002;0.002;0.002;0.002;0.002;0.002;0.002;0.002;0.002;0.002;0.002;0.002;0.002];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.0077678990893394481501;-0.48521554253968429693;3.1895363551766537924;0.084929806283691441915;0.12031579608707199114;0.048374732065154718574;1.5865248620909255806;-0.075847593649760222667;-0.35016736447871787963;0.082737031791634149669;0.031130869401107069683;-0.05106103864221157862;0.027091263539267471799;-0.29421501698813096182;0.66279555496939568382;-0.20042137862453507369;-0.31837886347391702868;0.91659136472056290668;0.15208136823303886054;0.32166791971137442818;0.90327106823880687347;-0.11730056995249425744;2.5974901590491286107;0.61376465715675143642;1.0940235088498091454];
IW1_1 = [0.011924229407379994053 0.009717718565842832848 0.029017526444894307242 -0.0069062911830412966954 0.015257593326404391212 0.0099315950128804116742 0.024004132430578938029 0.012784168941392519761 0.0091175559251552053264 0.034623468738316974525 0.049538328502125902886 0.01027024053286037554 0.00037283685860296106058 0.016967164018797241398 0.026474052588040690448 0.009115538264577482605 0.0192633523881955461 -0.013485373286384307046 0.00078691651748907624764 -0.0056752850629446212685 -0.012890701083906049712 -0.0049187190273224847686 0.0050102956098346746253 -0.013425011996867380892 -0.0046510989979975537328 0.010051009195039735736 0.019696505029336803388 0.010130103595302504885 0.030800001361928175392 0.020300826644678821725 0.032361597027424797435;-0.016060371993162531751 0.11161101469858164537 -0.01526452048946683876 0.029877629626368307214 0.022226557246293757175 0.032648421423497782368 0.026577022349572137355 -0.020686851276824735901 0.020434476064738207879 0.02672361791901186126 0.0010509235408343478406 0.0026872067064709140305 0.028895922690978653735 0.0077883154239077288794 -0.16143029579399051365 -0.089307676234085642264 0.011357689354012524829 0.047436230369225985959 -0.00047727105196312280154 0.10379268633895598339 0.074222835060203287694 0.05200041126630551569 0.041015171300473496352 0.039482074210727594044 0.08041045269476945756 0.000727848006761080751 -0.013791608287179402126 -2.7844946817069442192e-05 0.013397602826562902967 0.032172061419371858482 -0.078722798394183668425;-0.016305126131291640401 3.9543152970181272288 -0.0065665377023469712753 0.029572857435245850782 0.16322423524694584795 -0.035492360401232665723 0.060434079441549465317 0.29575323583530022109 0.049980533479042056622 0.11391202216354012755 -0.12258637118875249927 0.054503724814589156467 -0.16505764376207338051 0.16104119612136730266 0.23268455174771854321 0.097199214480661280668 0.030338741682368084579 0.012213232506474953204 -0.028733865254967561748 3.7548793112285987483 3.2656749553707955513 0.012889935566333549435 0.61194907971687817483 0.022274928229422598369 0.15524651303760025889 0.03482632119176853891 0.04754282181777853139 -0.041217810399025223145 0.063332483069374334583 -0.021076561398039532491 0.023677743918785302407;-0.82543969045146670105 -0.24009686527390181054 -0.1657074622177476253 -0.39035764550444557175 -0.44381019663202597725 -0.24224325366478674515 -0.68292815925860106407 -0.65659065154714180146 -0.10645723575692910001 -0.077547847470295902528 -1.0455879417175839574 -0.21913716137384225968 -0.13087340469917824182 -0.16734124759645052638 -0.56014503774234469802 -0.026945517419581191398 -1.2754293715112134944 0.49019298000164035489 0.47639486029591937566 -0.42210686551936504873 -0.293843724828011299 0.084473554862666250242 -0.29156711013389013942 -0.60179876929965625543 -0.50821001324468473292 -0.39151136586560136843 0.59847176242914512656 0.64074770547963011413 0.25299443833762885747 0.042634090127383526825 -0.75254220129938209638;0.11620366937578924249 0.023849172106206358024 0.025284001394130249663 0.13956766148991051057 -0.26945370050788902683 0.010532575614092142338 -0.076147770723419022643 -0.04355472728541722599 0.048780886210969216787 0.07529863653149726499 0.14687069795995680299 0.080760644650840276992 0.040815273270290212959 0.010921051044814528153 -0.019625442736295253821 -0.37123884088733438702 -0.11849315408323110588 0.19114739107361514159 0.0020091654238660683687 -0.02780115269806243336 -0.15802517865484447257 -0.079097472378013469752 0.026567254251316677754 0.10364644140666770533 -0.082246919027369136401 0.14744210145374633814 -0.14190126494945148883 -0.11829835563579013669 0.0054998858061652286869 -0.046446667763594337575 0.032995558222959540939;0.0039243621409088165486 -0.069608817017338869837 -0.088738608180361708277 0.16594565138950137517 0.099987067753436201234 -0.07256860004770386563 -0.057399611024420107985 0.049891995888432974504 -0.0012489945336788502595 -0.19680622979568238029 -0.058635229985422275545 0.054776256051298793937 -0.13905647597486833766 0.048250784107066929662 -0.087067398002053153494 0.04558368610179007463 0.083795891321517365635 0.13226456327959032477 0.074150413977475612692 0.028268084375364439798 -0.0007625592076874085053 -0.0071067585134236728461 -0.12034471422646568495 -0.11665905335230897233 -0.061677397389813821971 -0.085389055014619560935 0.080474884991880935026 -0.0825441190814987652 0.013633920481541161873 0.11317868413057959043 -0.20653102378504292758;0.53571797269088217153 0.73202161875826121662 -0.086210342409999279889 0.097857082033040304614 -0.041476999504208668379 -0.34138628162679074407 -0.23849861291520230155 0.50691489678194290303 0.067594792890826274623 -0.38803407761732378045 0.17108606178828697497 0.13668435842068163422 0.35584375017397140706 0.093518383433110724434 -0.56768434209976970095 -0.23173546056419297434 0.35244519029313986502 0.13491263887287352485 -0.20878482744495968637 0.22040669592102213326 0.36457529903453317344 -0.041461556518782437253 0.22776457202093988719 0.013622446637361543612 0.13277326495199368028 0.27263147613472810127 0.0057069272446267065718 -0.068349719960032223609 0.0091663804205586989909 0.10762158037442161318 0.10958653880980806505;0.057899910788677781681 -0.0059347865522716833006 0.094441635974699025824 0.010796464091109403416 -0.088519156177133073715 0.085738686342850353728 0.011555431353935198546 0.18498938530103004041 0.11670337565484635578 -0.017856114633556584986 0.11255929820612407821 0.015410618573926226915 0.020465304802730597405 -0.09988710314738649676 -0.13341469055551383183 -0.15348741626424014517 -0.064315314055260391912 -0.0070795359961142948629 -0.12149451738523005251 -0.065957403149610224768 0.011045054587229333198 -0.052773140914337497709 0.017949247992469996582 -0.11722081981138333939 0.0025423533067285542485 0.05622166649179034803 -0.019889959074654808835 0.061667409975419494594 -0.014358406455829014065 0.11992790741383853315 -0.010181899817280603768;0.076773562081818902403 0.14152206031375638706 -0.03618329829473607151 0.028562969442746739129 0.026908522236233294034 -0.12433102962311354256 0.0097023496689613315108 0.0098909329640091223773 0.012858240076528169166 0.21530073464709117981 -0.37644271775766646737 -0.1658642183997227626 0.025514381543293412902 -0.045295048195047225847 0.042059528659343509149 -0.17276757669644013382 -0.024634663458230340177 0.00475687092138196016 -0.16367433636092487692 -0.039535447521510391766 0.051179404250359016026 0.11804815021441200651 -0.055274866321808301117 0.051375986807474405271 -0.020496761867551758357 0.0046243726313323725227 0.011278161578093521059 -0.13563393627989075996 0.00078793711768518728041 -0.0078465414440953562547 -0.21844172813189841054;-0.036040779893509213017 0.098563865438256806351 0.04635120062163620297 -0.018947028127142502563 -0.16945291824171143658 -0.067914115399453550692 -0.049911681835473363511 -0.052415840476815689364 0.047908775863718944255 0.057810464499354424772 -0.048487609687086007104 -0.03709381021584449295 -0.0027725206846256258281 0.023809955089246961218 0.040684621380664011403 0.017001057738723356766 -0.018259595180392104025 -0.025003244488194870804 -0.0088377416080976430729 0.086483697959158972735 -0.068896034510609646673 0.016580119634652130262 0.020929653965077305716 -0.022543262595235015466 -0.073148835179451338062 0.012025046362365633332 -0.035050291734502768415 0.02497281591631747566 -0.069020642077779345569 -0.022274873978711411115 -0.0081050276854544543725;-0.86637677763261988773 -0.12731247130681763724 -0.13674754685538401122 -0.40147724440086723918 -0.38913819348995853931 -0.25457388469379849116 -0.73856930154197908411 -0.67554994320771089011 -0.10995729270152589108 -0.066172712011446491176 -1.13735292008370803 -0.28283860773722702131 -0.046886180780817375557 -0.19417078674172488784 -0.57998462683454099498 -0.0018302064542600525541 -1.3423807361637647428 0.41668224707697781861 0.45228495501829873993 -0.3889112219754808919 -0.25088041173736430611 0.1295258357426421203 -0.29703924205952159099 -0.68974430007843490209 -0.60517964437749838247 -0.43203048307256952665 0.63554036392980672865 0.75896526297895561264 0.32936776037005449647 0.037631454077530164526 -0.69616865493509560991;0.031757645062885031528 0.037699967371523111781 0.045703536723481978654 -0.089991281614544713086 -0.1106564715373759139 0.011362985486251749728 0.036932028466676120049 0.01301638009407372551 -0.019760320590054902129 0.16570409747063738481 0.080774380236907250552 -0.028292864599273586518 0.10390226339577393611 -0.039751865948335088352 0.011437582188862741375 0.027066534796561975834 -0.025245784836226439068 -0.022906259193025444582 0.055880962183487842276 -0.090465140753009057328 -0.04461461212943555743 -0.013115661640490387102 0.18322106802510068624 0.054220852925525760135 0.030904585309857717651 0.014014356340599203737 -0.0062526329740410077282 0.0097555288726453651127 -0.068110152301369825123 -0.0023402535221548198541 0.1375773727019840853;-0.055901565550717881303 -0.34348322132467651313 0.023551515782652590603 0.078479331288096490504 0.10684174903019294511 0.091031269007107493141 0.15144325020017262995 0.10173928897629261336 -0.037067699480700794235 -0.082518320114537663246 0.16153766651843204372 0.082092174165936795949 0.19340931732911503804 -0.12300388586921584544 -0.020900424522525412607 -0.064522218026718786144 -0.04147515675301859106 0.52999845771307574349 -0.026461584694655287953 -0.10782417401342403451 0.014542254875877496517 0.25371311221201053865 0.055394384106330248063 0.017314097445657063851 -0.086600353925450887504 0.058015853423641627895 0.18485611042583752206 -0.21973704938177279766 0.088330783065420831468 0.040835205224667596446 -0.24284725958571054538;0.13441465740457497757 -0.12756039597431537147 -0.15075092216862837069 -0.037816126739561674308 0.13960716236505446575 0.027479779937944263241 -0.035170485534722226162 -0.1578292091327048452 -0.048404319702609714671 0.19198258626148090311 -0.2067762442957166158 -0.26544039868159924334 0.028093260628366412829 -0.093367960615404241298 -0.045164292748939259547 -0.33371537404051077047 -0.068666703840312259821 0.033332112355425547179 -0.18522576623481373792 -0.15247443608956387506 0.20781674954139894851 0.15211266116466434783 -0.11713441190985418583 0.19743837712231748771 -0.031276462166475435533 -0.16451756533680653161 0.059743640520837734686 -0.26047105061839015416 -0.040741397631000195179 -0.014800244232228676119 -0.19351804062645436288;0.17695999495776665311 0.17795919717481678557 -0.06564204942665524678 0.011233195252483193713 -0.04048258387442835865 -0.083297220922690012879 -0.20837404409925630588 0.13519068516728516283 -0.14122032466107214965 -0.25356581435553360304 -0.16597451421120765214 -0.04759362728904061729 0.038947777642801544029 -0.06568438563580222822 -0.095062719552274424495 -0.22450988745568253857 -0.11466420142196194487 -0.02350860952002545648 0.046398868661612968634 -0.054775039707355463459 0.159900597663062638 -0.085754558809627928762 0.014831368351915683382 -0.052799140951539744182 -0.017983435263375879137 0.033477257208132424338 0.05227403379229950825 -0.033284991972127551951 -0.046124983031119302923 0.021428501323066406065 0.077374228016377361028;0.10553909032207565988 -0.17329275287335998978 -0.1246306279965657543 -0.030019894220939005031 0.11088725542608700303 0.095324039764672116593 -0.01510657119142973584 -0.13409805693184270736 -0.067062948498248092788 0.060926359498351588539 -0.070243124874361004273 -0.15055144933727473977 0.011305426062877085847 -0.10361868086660470933 -0.0016986751779463707141 -0.26716943453994257407 -0.1296683518362109766 0.020070247116736772419 -0.087420082822592420912 -0.13823958336883362952 0.19493731692244345433 0.067092200992556777495 -0.10175893159960681944 0.12229189647515077699 0.048615315219052671059 -0.13411000755884344704 0.060713407518373944949 -0.15991917590942575367 -0.031908007670896507135 -0.0055850468626762062724 -0.0684563207686917502;0.12316600815069486674 -0.015363487923485576528 -0.11322672032706955492 -0.025831275927166778145 0.076174998202605842534 -0.082147630199901178205 -0.015056343681378290406 -0.07144837441482444762 -0.025037575914078711442 0.25326333360869551781 -0.32434261986272311384 -0.26447699358432436023 0.027038313942217506725 -0.071667107117636227875 -0.031304765090469553745 -0.2898383989537903771 -0.0090888049406425575755 0.01592055736134830729 -0.23440927198640340579 -0.10507847147797899634 0.11542592122321743142 0.15160610010705619088 -0.050875218264271118707 0.16078099016460661863 -0.065636102068315424485 -0.12807790408330452236 0.024590163367190887023 -0.27019115467285981236 -0.033625957274407834718 -0.036850791284945547122 -0.28976023887721524819;-0.02398118332865434299 0.14737519041831045885 -0.014162771624043940868 0.03291385893840034077 0.032766546776399146923 0.038054260965751714185 0.034252417818487403134 -0.038648058169772313286 0.023796325022702336655 0.049123250800014582607 -0.0023602273331579100117 -0.0065490120693669591143 0.030375765101222886727 0.011684494458858678614 -0.10594682703254733325 -0.066613670309266931335 0.008946725011561254548 0.047139171635594973031 -0.0017317058048953374964 0.13443714821916430413 0.095823375472851357593 0.07217519257466989413 0.04690396112465046452 0.050915509456631001528 0.097969054297702778955 -0.0027188688578989911489 -0.014541023494537187385 -0.0022733438466231549804 0.018673083834944498999 0.034729172374034431026 -0.094936464202088399755;-0.79637709154950353518 -0.35790049425640696468 -0.19360218287303665452 -0.39941242146204186669 -0.49772418758579339837 -0.24585759277803309608 -0.65834901059249639754 -0.65114516088048401965 -0.11015204071159447052 -0.08788028657130014798 -0.99063745983819162522 -0.17529382058409784251 -0.19874041385247659397 -0.15404699206696478853 -0.54643206347478012752 -0.051543327452389660348 -1.2456193416719170131 0.54865258588322718403 0.50357921202571298558 -0.44938830715708971697 -0.35112294492818307834 0.051207338911157966599 -0.28571184137274141523 -0.53242518283649775679 -0.43299732587617417723 -0.37941711467836841676 0.56891596469889804677 0.55559471897746048885 0.19266848885094267629 0.037156965644419712169 -0.82883276141195116882;0.082765339741882562596 0.063192591300635050922 -0.026334773326402421273 0.046250714515221801049 0.031104442804269352013 0.018637038501762775294 0.025793748122277221357 0.050504665769744529202 0.025202040468840374715 0.20972493404514477855 0.15937104175223323899 0.066648865042412436255 -0.014261994738132157887 -0.036516431390558004577 0.012833275589253175658 -0.10250347060014383671 0.0026860573821674235163 -0.032942184782703810841 0.017177913449506310162 -0.03996933948159752531 -0.0067671978796233290057 -0.075344064928561743644 0.030797860394916328625 -0.0709197704880291796 0.014338466950014311374 0.064387588769201253847 -0.018855457398882991688 -0.017133480090269857105 0.0015144034088580952697 0.016799829853808106311 0.076892693424021260618;-0.15827071127824912655 0.12290840630128119226 0.04186179553334339748 0.026343368504886034709 0.053926240408194069109 0.015052653611894749319 0.13582177296669531441 -0.27865358909092341477 0.064470752076502796379 0.26987715263264094867 -0.042966722109448816924 -0.069332242668049409717 0.0016008854790184204406 0.048167497059879472998 0.31945266470825939287 0.15423019553510158852 -0.030288964269212643315 0.028889135912472704848 0.012252629525319521514 0.16901736026278030289 0.059397641407531967528 0.2179321927818753668 0.01202561516126634221 0.12444185958246915813 0.13292078001805099352 -0.074520998494380250032 -0.041121580317440828423 -0.018994575858427304588 0.04410171137799667046 0.0088267148271038084473 -0.21411369824239037674;-0.02640586491462944968 0.14547468991823647722 0.0012606085801235686252 0.03346835858131069763 0.014403584869252850781 0.065271231533698445548 0.011471810502571393175 0.055551859208140222379 -0.0038573726236625521281 -0.028620357564752320345 0.011514227667687256321 0.061140864193784338898 -0.043861702570715845051 0.067208331729284531697 -0.0145680829983703998 -0.033758984564175982535 -0.033554220010584480394 -0.0014669935153608047989 -0.02519139881999391678 0.45942433679644123501 0.16185929743419197324 -0.07439494353590012099 -0.090147437288950249545 -0.050429323766641165339 -0.073028686063807080053 -0.017795381108922290331 -0.017078270792350754015 -0.0086694194937464580386 -0.021909859740473103251 0.027393567839710426803 -0.010074217779690333024;-0.055117938817363716641 3.5041417840447945942 -0.0046199210078888153924 0.023045531282999395795 0.16915336433173597253 -0.012795005763164578327 0.050326563292970145913 0.2536041961427935032 0.05208969479752108972 0.06105779358540924795 -0.12217294692892007035 0.04187282725788173815 -0.15828776298834132397 0.13835175164383831103 0.18993825871412003958 0.099695704770975973608 0.023131716267685106803 0.0068564830299641882708 -0.023409986027846503565 3.1999353373299306291 2.7938833520490722329 -0.018125236877633645743 0.51983677920317938881 -0.0015062058473054979434 0.13147440459371062538 0.041788340153218604678 0.051957667073331388619 -0.047538806226320749759 0.053464717720283390368 -0.0030741621510553315128 0.029811601974351772948;0.062994360478136071646 -0.38616503026252013697 -0.010183603008686491903 -0.02979748291736250207 -0.077238633604165302105 -0.031852031842366380909 -0.070218279766577823553 0.1508897276471931892 -0.031383466099334338117 -0.23061193310702018944 0.0053408016316362364254 0.061779018329377662078 -0.049332463119417573061 -0.034696568035393851592 -0.12514639734635238377 -0.019303397412633253871 0.0007556775896494554107 -0.036469777446119122644 -0.011074772204305617651 -0.31510327474123572822 -0.24660186035735168208 -0.2306599282992332911 -0.11740829454233528417 -0.12236095903828324294 -0.20880537404596680173 0.016756225057773375953 0.0031904194912640718509 0.0014391018782477932054 -0.054776214930893858679 -0.025997568475229233115 0.18408422018665396291;0.39960009338226448738 0.71405035373027503365 -0.14738009488313660866 0.10140362437229553938 0.084612342439111143388 -0.3046442959340629475 -0.29403225304313085342 0.27513655002473991207 -0.1613448310661778351 -0.14163309378347227474 -0.37463552925325771525 -0.11735139203992739354 0.15641503741462631227 -0.072942023813102663254 -0.098400594940137420252 -0.428037127263466044 -0.093480197848341939348 0.023142131286814714153 -0.082132040637132919247 0.0020743761609551139916 0.47502816843369821687 0.094112468772928378757 -0.1381396101526837783 0.034434558847526670899 0.10708700380220875781 0.074996644359148226244 0.11873662312122539031 -0.12303962775033204513 -0.0033546342578323258034 0.13772602499888897398 -0.087145060344099828376];

% Layer 2
b2 = [-0.3484089532621434393;0.031061756525758536795];
LW2_1 = [-1.696731212681299894 1.1831119660329720844 -0.68658514706737672206 0.9918291616620091844 -0.21638529796188482601 -0.43787837582773664336 0.086179578382724483787 -0.57712059520168224047 -0.69031997791241139772 1.5009292686366402236 -0.46290158498318079161 -1.0273043197063416176 0.14622598575336936966 -0.92498987466724824635 0.46648360075990052964 0.85792186937674008718 0.86181579523739282322 0.41711614616857561888 -0.53504161015711015903 0.71909527962060337813 -0.45212655737519780175 -0.51284513365784434313 0.67246197446296274158 0.44406609529365492772 -0.14274895062058243211;2.5894203543092069175 0.66400544014791906822 0.0063042610912855782945 -0.009281753519458984733 -0.0048002881708716846343 0.0066011138404228784579 0.0013245997532690349102 -0.00085631138899327986953 -0.003945935036277306053 -0.0108596348117839369 0.0038581824199467539514 0.05269566490129335562 0.0024238300538931556449 -0.0011665726498900337669 -0.0015471954519052097746 -0.0079080899036652572975 0.0057186345653251133281 0.61458115861844819783 0.005538604228675654724 0.0077132018181290369976 -0.0048941388506495977703 0.0056993094811308500636 -0.0090195381012142632204 -0.040648365193661994965 -0.00096561295043641882756];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [2.24265530387979e-05;1.01569244832665e-05];
y1_step1.xoffset = [-149000;-330000];

% ===== SIMULATION ========
X = rand(1, 31)*(-500);
% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps

if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    disp(a1)
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
disp(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
disp(a)
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end